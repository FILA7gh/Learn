SQL-инъекции (SQL Injection) — это тип атаки на веб-приложения, при котором злоумышленник вставляет
(или «инъектирует») вредоносные SQL-запросы в поля ввода пользовательских данных.
Цель такой атаки — исполнить произвольные SQL-запросы на базе данных приложения,
что может привести к различным негативным последствиям, таким как:

    Получение несанкционированного доступа к данным:
        Атака может позволить злоумышленнику прочитать, изменить или удалить данные, к которым он не должен иметь доступ.


    Изменение структуры базы данных:
        Вредоносные запросы могут модифицировать структуру базы данных (например, удаление или изменение таблиц).


    Обход аутентификации:
        Атака может позволить обойти механизмы аутентификации и авторизации, предоставляя доступ к аккаунтам других пользователей.


    Исполнение произвольного кода на сервере базы данных:
        В некоторых случаях злоумышленник может получить возможность выполнить произвольный код на сервере базы данных,
        что может привести к полному компрометированию системы.


Пример SQL-инъекции

    Рассмотрим пример кода на Python с использованием библиотеки sqlite3, который подвержен SQL-инъекции:

        import sqlite3

        # Подключение к базе данных
        conn = sqlite3.connect('example.db')
        cursor = conn.cursor()

        # Ввод пользователя
        username = input("Enter username: ")
        password = input("Enter password: ")

        # Формирование уязвимого SQL-запроса
        query = f"SELECT * FROM users WHERE username = '{username}' AND password = '{password}'"
        cursor.execute(query)

        # Получение результатов
        result = cursor.fetchall()
        print(result)

        # Закрытие подключения
        conn.close()

        Если злоумышленник введет в поле username значение ' OR '1'='1 и в поле password любое значение,
        итоговый запрос будет выглядеть так:

            SELECT * FROM users WHERE username = '' OR '1'='1' AND password = 'password'

        Запрос всегда вернет все строки из таблицы users, так как условие '1'='1' всегда истинно.
        Это позволяет злоумышленнику обойти аутентификацию и получить доступ к данным.


Защита от SQL-инъекций

    Использование параметризованных запросов (Prepared Statements):
        Параметризованные запросы отделяют данные от кода SQL-запроса, что предотвращает возможность инъекции.


    Пример на Python с использованием библиотеки sqlite3:

        import sqlite3

        # Подключение к базе данных
        conn = sqlite3.connect('example.db')
        cursor = conn.cursor()

        # Ввод пользователя
        username = input("Enter username: ")
        password = input("Enter password: ")

        # Формирование безопасного SQL-запроса с параметрами
        query = "SELECT * FROM users WHERE username = ? AND password = ?"
        cursor.execute(query, (username, password))

        # Получение результатов
        result = cursor.fetchall()
        print(result)

        # Закрытие подключения
        conn.close()

    Экранирование входных данных:
        Применение функций экранирования уменьшает риск инъекции, но лучше использовать параметризованные запросы.


    Ограничение прав доступа к базе данных:
        Приложение должно работать с базой данных под учетной записью, которая имеет минимально необходимые привилегии.


    Использование ORM (Object-Relational Mapping):
        ORM-ы обычно предоставляют встроенные механизмы для защиты от SQL-инъекций.


    Валидация и фильтрация входных данных:
        Проверка и ограничение типов и диапазонов вводимых данных.



SQL-инъекции остаются одной из самых распространенных уязвимостей в веб-приложениях,
поэтому важно соблюдать меры предосторожности и регулярно проводить аудит безопасности кода.
