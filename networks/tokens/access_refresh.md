
Access токены и refresh токены используются в системах аутентификации и авторизации для управления доступом к ресурсам
и обеспечивают безопасность и удобство для пользователей. Давайте рассмотрим их подробнее.


Access токен — это временный токен, который используется для доступа к защищенным ресурсам.
Этот токен выдается после успешной аутентификации и используется для идентификации пользователя при каждом запросе к серверу.


Характеристики Access токена:

    Временное действие: Обычно имеет короткий срок действия (например, несколько минут или часов).

    Использование: Включается в заголовок HTTP-запроса (чаще всего в заголовке Authorization как Bearer <token>).

    Права доступа: Может содержать информацию о правах доступа и разрешениях пользователя.



Refresh токен — это токен, который используется для получения нового access токена после истечения срока его действия.
Refresh токен обычно имеет более длительный срок действия и используется для обновления access токена
без необходимости повторной аутентификации пользователя.


Характеристики Refresh токена:

    Длительное действие: Имеет более долгий срок действия (например, несколько дней, недель или месяцев).

    Безопасность: Обычно хранится более безопасно, поскольку его компрометация может привести к выдаче новых access токенов.

    Использование: Отправляется на сервер для получения нового access токена, когда текущий access токен истекает.



Как это работает вместе

    Аутентификация пользователя:

        Пользователь вводит свои учетные данные (например, логин и пароль).
        Сервер проверяет учетные данные и, если они верны, выдает пару токенов: access токен и refresh токен.


    Использование access токена:

        При каждом запросе к защищенным ресурсам клиент отправляет access токен в заголовке HTTP-запроса.
        Сервер проверяет валидность access токена и предоставляет доступ к ресурсу, если токен действителен.


    Обновление access токена:

        Когда access токен истекает, клиент отправляет refresh токен на сервер для получения нового access токена.

        Сервер проверяет валидность refresh токена и, если он действителен, выдает новый access токен 
        (и, возможно, новый refresh токен).



Пример использования в Django

    Для реализации в Django можно использовать библиотеки, такие как djangorestframework-simplejwt,
    которые предоставляют встроенную поддержку для работы с access и refresh токенами.


        Установка библиотеки:

            pip install djangorestframework-simplejwt

            Настройка Django:

            python

            # settings.py
            INSTALLED_APPS = [
                ...
                'rest_framework',
                'rest_framework_simplejwt',
            ]

            REST_FRAMEWORK = {
                'DEFAULT_AUTHENTICATION_CLASSES': (
                    'rest_framework_simplejwt.authentication.JWTAuthentication',
                ),
            }


    Создание представлений (views) для получения токенов:

        # views.py
        from rest_framework_simplejwt.views import (
            TokenObtainPairView,
            TokenRefreshView,
        )

        urlpatterns = [
            path('api/token/', TokenObtainPairView.as_view(), name='token_obtain_pair'),
            path('api/token/refresh/', TokenRefreshView.as_view(), name='token_refresh'),
        ]


    Использование токенов в запросах:

        Клиент запрашивает пару токенов, отправляя POST-запрос на api/token/ с учетными данными пользователя.
        Получив access и refresh токены, клиент использует access токен для доступа к защищенным ресурсам, 
        включая его в заголовок Authorization как Bearer <access_token>.
        Когда access токен истекает, клиент отправляет POST-запрос на api/token/refresh/ 
        с refresh токеном для получения нового access токена.


Пример запроса токенов

    Запрос access и refresh токенов:
        
        POST /api/token/
        
        {
            "username": "user",
            "password": "pass"
        }
        
    Ответ:
        
        {
            "access": "<access_token>",
            "refresh": "<refresh_token>"
        }


    Использование access токена для доступа к защищенным ресурсам:
        
        GET /api/protected/
        Authorization: Bearer <access_token>

    
    Обновление access токена:
        
        POST /api/token/refresh/
        {
            "refresh": "<refresh_token>"
        }
        
    Ответ:
    
        {
            "access": "<new_access_token>"
        }


Использование пары access и refresh токенов позволяет создать более безопасную и удобную систему аутентификации, 
минимизируя риски, связанные с компрометацией токенов и улучшая пользовательский опыт.
