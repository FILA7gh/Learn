Subquery в Django ORM представляет собой объект, который позволяет встраивать один запрос (подзапрос) в другой запрос.
Это полезный инструмент для выполнения сложных запросов к базе данных, включая запросы,
которые зависят от результатов других запросов.


Subquery может быть использован в различных контекстах, таких как фильтрация, аннотация, условия сортировки
и другие операции. Он позволяет передать результаты подзапроса в основной запрос,
что обеспечивает гибкость и возможность создания более сложных запросов.


Пример использования Subquery:

    from django.db.models import Subquery

    # Пример: аннотация с использованием подзапроса для получения максимального значения поля 'value'
    # из другой связанной модели 'RelatedModel' для каждой записи
    queryset = MainModel.objects.annotate(
        max_related_value=Subquery(
            RelatedModel.objects.filter(main_model_id=OuterRef('pk')).order_by('-value').values('value')[:1]
        )
    )

    В этом примере Subquery используется для создания аннотации max_related_value, которая представляет
    собой максимальное значение поля value из связанной модели RelatedModel для каждой записи MainModel.
    Подзапрос фильтруется по ключу основной модели (OuterRef('pk')) и сортируется по убыванию значения поля value.


Subquery представляет собой мощный инструмент для создания более сложных и выразительных запросов
к базе данных в Django ORM. Он позволяет встраивать один запрос в другой и использовать результаты подзапросов
в основных запросах для выполнения различных операций.
